{"is_source_file": true, "format": "Python", "description": "This is a FastAPI application implementing a notification service with WebSocket streaming, REST endpoints for sending notifications, and in-memory WebSocket connection management. It defines data models with Pydantic, handles WebSocket connections with filters, and provides endpoints for notification creation, WebSocket streaming, and health checks.", "external_files": ["fastapi", "pydantic", "uvicorn", "os", "json", "uuid", "asyncio", "datetime"], "external_methods": ["FastAPI()", "APIRouter()", "cors_middleware.CORSMiddleware", "json.dumps", "uuid.uuid4", "datetime.now", "datetime.now(timezone.utc)", "os.getenv", "status.HTTP_202_ACCEPTED", "WebSocket.accept", "WebSocket.receive_text", "WebSocket.send_text", "WebSocketDisconnect", "uvicorn.run"], "published": ["app", "router", "Notification", "NotificationCreateRequest", "ConnectionManager", "post_notification"], "classes": [{"name": "ConnectionManager", "description": "Manages WebSocket connections and subscriptions, allowing broadcasting messages to filtered clients."}], "methods": [{"name": "None connect(self, websocket: WebSocket, user_id: Optional[str], topic: Optional[str])", "description": "Accepts a WebSocket connection and registers the client with subscription filters.", "scope": "ConnectionManager", "scopeKind": "class"}, {"name": "None disconnect(self, websocket: WebSocket)", "description": "Removes a WebSocket connection from active connections.", "scope": "ConnectionManager", "scopeKind": "class"}, {"name": "None broadcast(self, message: Dict[str, Any])", "description": "Sends a message to all WebSocket clients matching their subscription filters.", "scope": "ConnectionManager", "scopeKind": "class"}, {"name": "None __init__(self)", "scope": "ConnectionManager", "scopeKind": "class", "description": "unavailable"}, {"name": "health()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "post_notification(payload: NotificationCreateRequest)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "root()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] validate_channel(cls, v: Optional[str])", "scope": "NotificationCreateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str validate_type(cls, v: str)", "scope": "NotificationCreateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "websocket_endpoint(websocket: WebSocket)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "websocket_help()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["FastAPI()", "APIRouter()", "app.add_middleware", "app.include_router", "app.get", "app.post", "app.websocket", "uvicorn.run"], "search-terms": ["WebSocket", "Notification", "ConnectionManager", "FastAPI", "notification", "stream", "broadcast", "in_app", "NotificationType", "app.main", "NotificationService"], "state": 2, "file_id": 4, "knowledge_revision": 9, "git_revision": "", "ctags": [{"_type": "tag", "name": "Channel", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^class Channel(str):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ConnectionManager", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^class ConnectionManager:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "EMAIL", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    EMAIL = \"email\"$/", "language": "Python", "kind": "variable", "scope": "Channel", "scopeKind": "class"}, {"_type": "tag", "name": "IN_APP", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    IN_APP = \"in_app\"$/", "language": "Python", "kind": "variable", "scope": "Channel", "scopeKind": "class"}, {"_type": "tag", "name": "Notification", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^class Notification(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "NotificationCreateRequest", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^class NotificationCreateRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "NotificationType", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^class NotificationType(str):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ORDER_UPDATE", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    ORDER_UPDATE = \"order_update\"$/", "language": "Python", "kind": "variable", "scope": "NotificationType", "scopeKind": "class"}, {"_type": "tag", "name": "PROMOTION", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    PROMOTION = \"promotion\"$/", "language": "Python", "kind": "variable", "scope": "NotificationType", "scopeKind": "class"}, {"_type": "tag", "name": "PUSH", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    PUSH = \"push\"$/", "language": "Python", "kind": "variable", "scope": "Channel", "scopeKind": "class"}, {"_type": "tag", "name": "REVIEW_EVENT", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    REVIEW_EVENT = \"review_event\"$/", "language": "Python", "kind": "variable", "scope": "NotificationType", "scopeKind": "class"}, {"_type": "tag", "name": "SMS", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    SMS = \"sms\"$/", "language": "Python", "kind": "variable", "scope": "Channel", "scopeKind": "class"}, {"_type": "tag", "name": "SYSTEM", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    SYSTEM = \"system\"$/", "language": "Python", "kind": "variable", "scope": "NotificationType", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "ConnectionManager", "scopeKind": "class"}, {"_type": "tag", "name": "allowed_origins", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^allowed_origins = os.getenv(\"CORS_ALLOWED_ORIGINS\", \"*\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    body: Optional[str] = Field(None, description=\"Notification body\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    body: Optional[str] = Field(None, description=\"Notification body\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "broadcast", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    async def broadcast(self, message: Dict[str, Any]) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, message: Dict[str, Any])", "scope": "ConnectionManager", "scopeKind": "class"}, {"_type": "tag", "name": "channels", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    channels: Optional[List[str]] = Field($/", "language": "Python", "typeref": "typename:Optional[List[str]]", "kind": "variable", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "connect", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    async def connect(self, websocket: WebSocket, user_id: Optional[str], topic: Optional[str]) /", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, websocket: WebSocket, user_id: Optional[str], topic: Optional[str])", "scope": "ConnectionManager", "scopeKind": "class"}, {"_type": "tag", "name": "createdAt", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    createdAt: datetime = Field(..., description=\"Creation timestamp in ISO8601 format\")$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    data: Optional[Dict[str, Any]] = Field(None, description=\"Additional metadata payload\")$/", "language": "Python", "typeref": "typename:Optional[Dict[str, Any]]", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    data: Optional[Dict[str, Any]] = Field(None, description=\"Arbitrary key-value payload\")$/", "language": "Python", "typeref": "typename:Optional[Dict[str, Any]]", "kind": "variable", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "disconnect", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    async def disconnect(self, websocket: WebSocket) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, websocket: WebSocket)", "scope": "ConnectionManager", "scopeKind": "class"}, {"_type": "tag", "name": "health", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^def health():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    id: str = Field(..., description=\"Unique notification identifier\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "manager", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^manager = ConnectionManager()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "orderId", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    orderId: Optional[str] = Field(None, description=\"Associated order identifier (optional)\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "orderId", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    orderId: Optional[str] = Field(None, description=\"Order ID associated with the notification\"/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "port", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    port = int(os.getenv(\"PORT\", \"8106\"))$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "post_notification", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^async def post_notification(payload: NotificationCreateRequest):$/", "language": "Python", "kind": "function", "signature": "(payload: NotificationCreateRequest)"}, {"_type": "tag", "name": "read", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    read: bool = Field(default=False, description=\"Read status\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "root", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^def root():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    title: str = Field(..., description=\"Notification title\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    title: str = Field(..., description=\"Notification title\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "topic", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    topic: Optional[str] = Field(None, description=\"Target topic to broadcast to (optional)\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    type: str = Field(..., description=\"Type of notification (order_update, promotion, system, r/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    type: str = Field(..., description=\"Type of notification (order_update, promotion, system, r/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "userId", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    userId: Optional[str] = Field(None, description=\"Target user identifier (optional)\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "userId", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    userId: Optional[str] = Field(None, description=\"User ID the notification targets\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "validate_channel", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    def validate_channel(cls, v: Optional[str]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "member", "signature": "(cls, v: Optional[str])", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "validate_type", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^    def validate_type(cls, v: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(cls, v: str)", "scope": "NotificationCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "websocket_endpoint", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^async def websocket_endpoint(websocket: WebSocket):$/", "language": "Python", "kind": "function", "signature": "(websocket: WebSocket)"}, {"_type": "tag", "name": "websocket_help", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15103/NotificationService/app/main.py", "pattern": "/^async def websocket_help():$/", "language": "Python", "kind": "function", "signature": "()"}], "hash": "b887f331dbb83dcc928acda7b75c665b", "format-version": 4, "code-base-name": "NotificationService", "filename": "NotificationService/app/main.py", "fields": [{"name": "EMAIL = \"email\"", "scope": "Channel", "scopeKind": "class", "description": "unavailable"}, {"name": "IN_APP = \"in_app\"", "scope": "Channel", "scopeKind": "class", "description": "unavailable"}, {"name": "ORDER_UPDATE = \"order_update\"", "scope": "NotificationType", "scopeKind": "class", "description": "unavailable"}, {"name": "PROMOTION = \"promotion\"", "scope": "NotificationType", "scopeKind": "class", "description": "unavailable"}, {"name": "PUSH = \"push\"", "scope": "Channel", "scopeKind": "class", "description": "unavailable"}, {"name": "REVIEW_EVENT = \"review_event\"", "scope": "NotificationType", "scopeKind": "class", "description": "unavailable"}, {"name": "SMS = \"sms\"", "scope": "Channel", "scopeKind": "class", "description": "unavailable"}, {"name": "SYSTEM = \"system\"", "scope": "NotificationType", "scopeKind": "class", "description": "unavailable"}, {"name": "allowed_origins = os.getenv(\"CORS_ALLOWED_ORIGINS\", \"*\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] body", "scope": "Notification", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[List[str]] channels", "scope": "NotificationCreateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "datetime createdAt", "scope": "Notification", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[Dict[str, Any]] data", "scope": "Notification", "scopeKind": "class", "description": "unavailable"}, {"name": "str id", "scope": "Notification", "scopeKind": "class", "description": "unavailable"}, {"name": "manager = ConnectionManager()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] orderId", "scope": "NotificationCreateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "port = int(os.getenv(\"PORT\", \"8106\"))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool read", "scope": "Notification", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str title", "scope": "Notification", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] topic", "scope": "NotificationCreateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str type", "scope": "Notification", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] userId", "scope": "NotificationCreateRequest", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"9": ""}]}